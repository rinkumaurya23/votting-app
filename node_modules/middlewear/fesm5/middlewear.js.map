{"version":3,"file":"middlewear.js.map","sources":["ng://middlewear/lib/middlewear.service.ts","ng://middlewear/lib/middlewear.module.ts"],"sourcesContent":["import { Injectable, EventEmitter } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n// import { environment } from 'environments/environment';\nlet environment;\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MiddlewareService {\n  items = new EventEmitter();\n  facets = new EventEmitter();\n  breadcrumbs = new EventEmitter();\n\n  constructor(private readonly http: HttpClient) { }\n\n  getCollectionByQuery(url?: string) {\n    url = url ? url : '';\n    return this.http.get(environment.apiUrl + 'category/' + url).subscribe(\n      (data: any) => {\n        console.log(data);\n        const result = data.universes.universe[0];\n        this.mapFredHopperProductsToProduct(result['items-section'].items.item);\n        this.mapFredHopperFacetMapToFacetMap(result.facetmap[0].filter);\n        this.mapFredHopperBreadcrumbsToBreadcrumbs(result.breadcrumbs);\n      });\n    }\n\n    mapFredHopperBreadcrumbsToBreadcrumbs(breadcrumbObject) {\n      const breadcrumbs = [];\n\n      this.breadcrumbs.emit(breadcrumbObject);\n    }\n\n    mapFredHopperFacetMapToFacetMap(listOfFredHopperFacetMaps: Array<any>) {\n      let facets = [];\n      facets = listOfFredHopperFacetMaps;\n      this.facets.emit(facets);\n\n    }\n\n    mapFredHopperProductsToProduct(listOfFredHopperProducts) {\n      const items = [];\n      listOfFredHopperProducts.forEach(element => {\n        const id = element.id;\n        const nameElement = element.attribute.find(x => x.name = 'name');\n        const name = nameElement.value[0].value;\n        const originalPriceElement = element.attribute.find(x => x.name === 'original_price');\n        const originalPrice = originalPriceElement.value[0].value;\n        const currentPriceElement = element.attribute.find(x => x.name === 'price');\n        const salePrice = currentPriceElement.value[0].value !== originalPrice ? currentPriceElement.value[0].value : '';\n        const imageElement = element.attribute.find(x => x.name === '_thumburl');\n        const image = imageElement.value[0].value;\n        const brandElement = element.attribute.find(x => x.name === 'brand');\n        const brand = brandElement.value[0].value ? brandElement.value[0].value : '';\n        items.push(new Product(id, name, image, originalPrice, salePrice,  brand));\n      });\n      this.items.emit(items);\n    }\n\n    navigateTo(url) {\n      this.getCollectionByQuery(url);\n    }\n}\n\nexport class Product {\n  constructor(id, name, image, originalPrice, salePrice?,  brand?) {\n    this.id = id;\n    this.name = name;\n    this.originalPrice = parseFloat(originalPrice.replace(/[^0-9\\.-]+/g, ''));\n    this.salePrice = parseFloat(salePrice.replace(/[^0-9\\.-]+/g, ''));\n    this.image = image;\n    this.brand = brand;\n\n  }\n  id: string;\n  name: string;\n  originalPrice: number;\n  salePrice?: number;\n  image: string;\n  brand?: string;\n}\n","import { NgModule, InjectionToken } from '@angular/core';\nimport { MiddlewareService } from './middlewear.service';\nimport { HttpClientModule } from '@angular/common/http';\nexport const API_HOST = new InjectionToken('API_HOST');\n\n@NgModule({\n  imports: [HttpClientModule],\n  providers: [MiddlewareService],\n})\nexport class MiddlewearModule {\n  static forRoot(host: string) {\n    return {\n      ngModule: MiddlewearModule,\n      providers: [{\n        provide: API_HOST,\n        useValue: host\n      }]\n    };\n  }\n}\n"],"names":[],"mappings":"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"}
