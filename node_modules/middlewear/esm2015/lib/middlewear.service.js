/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, EventEmitter } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
// import { environment } from 'environments/environment';
/** @type {?} */
let environment;
export class MiddlewareService {
    /**
     * @param {?} http
     */
    constructor(http) {
        this.http = http;
        this.items = new EventEmitter();
        this.facets = new EventEmitter();
        this.breadcrumbs = new EventEmitter();
    }
    /**
     * @param {?=} url
     * @return {?}
     */
    getCollectionByQuery(url) {
        url = url ? url : '';
        return this.http.get(environment.apiUrl + 'category/' + url).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            console.log(data);
            /** @type {?} */
            const result = data.universes.universe[0];
            this.mapFredHopperProductsToProduct(result['items-section'].items.item);
            this.mapFredHopperFacetMapToFacetMap(result.facetmap[0].filter);
            this.mapFredHopperBreadcrumbsToBreadcrumbs(result.breadcrumbs);
        }));
    }
    /**
     * @param {?} breadcrumbObject
     * @return {?}
     */
    mapFredHopperBreadcrumbsToBreadcrumbs(breadcrumbObject) {
        /** @type {?} */
        const breadcrumbs = [];
        this.breadcrumbs.emit(breadcrumbObject);
    }
    /**
     * @param {?} listOfFredHopperFacetMaps
     * @return {?}
     */
    mapFredHopperFacetMapToFacetMap(listOfFredHopperFacetMaps) {
        /** @type {?} */
        let facets = [];
        facets = listOfFredHopperFacetMaps;
        this.facets.emit(facets);
    }
    /**
     * @param {?} listOfFredHopperProducts
     * @return {?}
     */
    mapFredHopperProductsToProduct(listOfFredHopperProducts) {
        /** @type {?} */
        const items = [];
        listOfFredHopperProducts.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            /** @type {?} */
            const id = element.id;
            /** @type {?} */
            const nameElement = element.attribute.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.name = 'name'));
            /** @type {?} */
            const name = nameElement.value[0].value;
            /** @type {?} */
            const originalPriceElement = element.attribute.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.name === 'original_price'));
            /** @type {?} */
            const originalPrice = originalPriceElement.value[0].value;
            /** @type {?} */
            const currentPriceElement = element.attribute.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.name === 'price'));
            /** @type {?} */
            const salePrice = currentPriceElement.value[0].value !== originalPrice ? currentPriceElement.value[0].value : '';
            /** @type {?} */
            const imageElement = element.attribute.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.name === '_thumburl'));
            /** @type {?} */
            const image = imageElement.value[0].value;
            /** @type {?} */
            const brandElement = element.attribute.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.name === 'brand'));
            /** @type {?} */
            const brand = brandElement.value[0].value ? brandElement.value[0].value : '';
            items.push(new Product(id, name, image, originalPrice, salePrice, brand));
        }));
        this.items.emit(items);
    }
    /**
     * @param {?} url
     * @return {?}
     */
    navigateTo(url) {
        this.getCollectionByQuery(url);
    }
}
MiddlewareService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
MiddlewareService.ctorParameters = () => [
    { type: HttpClient }
];
/** @nocollapse */ MiddlewareService.ngInjectableDef = i0.defineInjectable({ factory: function MiddlewareService_Factory() { return new MiddlewareService(i0.inject(i1.HttpClient)); }, token: MiddlewareService, providedIn: "root" });
if (false) {
    /** @type {?} */
    MiddlewareService.prototype.items;
    /** @type {?} */
    MiddlewareService.prototype.facets;
    /** @type {?} */
    MiddlewareService.prototype.breadcrumbs;
    /**
     * @type {?}
     * @private
     */
    MiddlewareService.prototype.http;
}
export class Product {
    /**
     * @param {?} id
     * @param {?} name
     * @param {?} image
     * @param {?} originalPrice
     * @param {?=} salePrice
     * @param {?=} brand
     */
    constructor(id, name, image, originalPrice, salePrice, brand) {
        this.id = id;
        this.name = name;
        this.originalPrice = parseFloat(originalPrice.replace(/[^0-9\.-]+/g, ''));
        this.salePrice = parseFloat(salePrice.replace(/[^0-9\.-]+/g, ''));
        this.image = image;
        this.brand = brand;
    }
}
if (false) {
    /** @type {?} */
    Product.prototype.id;
    /** @type {?} */
    Product.prototype.name;
    /** @type {?} */
    Product.prototype.originalPrice;
    /** @type {?} */
    Product.prototype.salePrice;
    /** @type {?} */
    Product.prototype.image;
    /** @type {?} */
    Product.prototype.brand;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlkZGxld2Vhci5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbWlkZGxld2Vhci8iLCJzb3VyY2VzIjpbImxpYi9taWRkbGV3ZWFyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQzs7Ozs7SUFFOUMsV0FBVztBQU1mLE1BQU0sT0FBTyxpQkFBaUI7Ozs7SUFLNUIsWUFBNkIsSUFBZ0I7UUFBaEIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUo3QyxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUMzQixXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM1QixnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUFFZ0IsQ0FBQzs7Ozs7SUFFbEQsb0JBQW9CLENBQUMsR0FBWTtRQUMvQixHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNyQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsV0FBVyxHQUFHLEdBQUcsQ0FBQyxDQUFDLFNBQVM7Ozs7UUFDcEUsQ0FBQyxJQUFTLEVBQUUsRUFBRTtZQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7O2tCQUNaLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDekMsSUFBSSxDQUFDLDhCQUE4QixDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEUsSUFBSSxDQUFDLCtCQUErQixDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFD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QzVCLHdDQUFpQzs7Ozs7SUFFckIsaUNBQWlDOztBQW1EL0MsTUFBTSxPQUFPLE9BQU87Ozs7Ozs7OztJQUNsQixZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRSxTQUFVLEVBQUcsS0FBTTtRQUM3RCxJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQztRQUNiLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxhQUFhLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLFNBQVMsR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsRSxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztJQUVyQixDQUFDO0NBT0Y7OztJQU5DLHFCQUFXOztJQUNYLHVCQUFhOztJQUNiLGdDQUFzQjs7SUFDdEIsNEJBQW1COztJQUNuQix3QkFBYzs7SUFDZCx3QkFBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbi8vIGltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSAnZW52aXJvbm1lbnRzL2Vudmlyb25tZW50JztcbmxldCBlbnZpcm9ubWVudDtcblxuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBNaWRkbGV3YXJlU2VydmljZSB7XG4gIGl0ZW1zID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBmYWNldHMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIGJyZWFkY3J1bWJzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgaHR0cDogSHR0cENsaWVudCkgeyB9XG5cbiAgZ2V0Q29sbGVjdGlvbkJ5UXVlcnkodXJsPzogc3RyaW5nKSB7XG4gICAgdXJsID0gdXJsID8gdXJsIDogJyc7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQoZW52aXJvbm1lbnQuYXBpVXJsICsgJ2NhdGVnb3J5LycgKyB1cmwpLnN1YnNjcmliZShcbiAgICAgIChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGRhdGEudW5pdmVyc2VzLnVuaXZlcnNlWzBdO1xuICAgICAgICB0aGlzLm1hcEZyZWRIb3BwZXJQcm9kdWN0c1RvUHJvZHVjdChyZXN1bHRbJ2l0ZW1zLXNlY3Rpb24nXS5pdGVtcy5pdGVtKTtcbiAgICAgICAgdGhpcy5tYXBGcmVkSG9wcGVyRmFjZXRNYXBUb0ZhY2V0TWFwKHJlc3VsdC5mYWNldG1hcFswXS5maWx0ZXIpO1xuICAgICAgICB0aGlzLm1hcEZyZWRIb3BwZXJCcmVhZGNydW1ic1RvQnJlYWRjcnVtYnMocmVzdWx0LmJyZWFkY3J1bWJzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIG1hcEZyZWRIb3BwZXJCcmVhZGNydW1ic1RvQnJlYWRjcnVtYnMoYnJlYWRjcnVtYk9iamVjdCkge1xuICAgICAgY29uc3QgYnJlYWRjcnVtYnMgPSBbXTtcblxuICAgICAgdGhpcy5icmVhZGNydW1icy5lbWl0KGJyZWFkY3J1bWJPYmplY3QpO1xuICAgIH1cblxuICAgIG1hcEZyZWRIb3BwZXJGYWNldE1hcFRvRmFjZXRNYXAobGlzdE9mRnJlZEhvcHBlckZhY2V0TWFwczogQXJyYXk8YW55Pikge1xuICAgICAgbGV0IGZhY2V0cyA9IFtdO1xuICAgICAgZmFjZXRzID0gbGlzdE9mRnJlZEhvcHBlckZhY2V0TWFwcztcbiAgICAgIHRoaXMuZmFjZXRzLmVtaXQoZmFjZXRzKTtcblxuICAgIH1cblxuICAgIG1hcEZyZWRIb3BwZXJQcm9kdWN0c1RvUHJvZHVjdChsaXN0T2ZGcmVkSG9wcGVyUHJvZHVjdHMpIHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gW107XG4gICAgICBsaXN0T2ZGcmVkSG9wcGVyUHJvZHVjdHMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBlbGVtZW50LmlkO1xuICAgICAgICBjb25zdCBuYW1lRWxlbWVudCA9IGVsZW1lbnQuYXR0cmlidXRlLmZpbmQoeCA9PiB4Lm5hbWUgPSAnbmFtZScpO1xuICAgICAgICBjb25zdCBuYW1lID0gbmFtZUVsZW1lbnQudmFsdWVbMF0udmFsdWU7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUHJpY2VFbGVtZW50ID0gZWxlbWVudC5hdHRyaWJ1dGUuZmluZCh4ID0+IHgubmFtZSA9PT0gJ29yaWdpbmFsX3ByaWNlJyk7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUHJpY2UgPSBvcmlnaW5hbFByaWNlRWxlbWVudC52YWx1ZVswXS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3VycmVudFByaWNlRWxlbWVudCA9IGVsZW1lbnQuYXR0cmlidXRlLmZpbmQoeCA9PiB4Lm5hbWUgPT09ICdwcmljZScpO1xuICAgICAgICBjb25zdCBzYWxlUHJpY2UgPSBjdXJyZW50UHJpY2VFbGVtZW50LnZhbHVlWzBdLnZhbHVlICE9PSBvcmlnaW5hbFByaWNlID8gY3VycmVudFByaWNlRWxlbWVudC52YWx1ZVswXS52YWx1ZSA6ICcnO1xuICAgICAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSBlbGVtZW50LmF0dHJpYnV0ZS5maW5kKHggPT4geC5uYW1lID09PSAnX3RodW1idXJsJyk7XG4gICAgICAgIGNvbnN0IGltYWdlID0gaW1hZ2VFbGVtZW50LnZhbHVlWzBdLnZhbHVlO1xuICAgICAgICBjb25zdCBicmFuZEVsZW1lbnQgPSBlbGVtZW50LmF0dHJpYnV0ZS5maW5kKHggPT4geC5uYW1lID09PSAnYnJhbmQnKTtcbiAgICAgICAgY29uc3QgYnJhbmQgPSBicmFuZEVsZW1lbnQudmFsdWVbMF0udmFsdWUgPyBicmFuZEVsZW1lbnQudmFsdWVbMF0udmFsdWUgOiAnJztcbiAgICAgICAgaXRlbXMucHVzaChuZXcgUHJvZHVjdChpZCwgbmFtZSwgaW1hZ2UsIG9yaWdpbmFsUHJpY2UsIHNhbGVQcmljZSwgIGJyYW5kKSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuaXRlbXMuZW1pdChpdGVtcyk7XG4gICAgfVxuXG4gICAgbmF2aWdhdGVUbyh1cmwpIHtcbiAgICAgIHRoaXMuZ2V0Q29sbGVjdGlvbkJ5UXVlcnkodXJsKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9kdWN0IHtcbiAgY29uc3RydWN0b3IoaWQsIG5hbWUsIGltYWdlLCBvcmlnaW5hbFByaWNlLCBzYWxlUHJpY2U/LCAgYnJhbmQ/KSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5vcmlnaW5hbFByaWNlID0gcGFyc2VGbG9hdChvcmlnaW5hbFByaWNlLnJlcGxhY2UoL1teMC05XFwuLV0rL2csICcnKSk7XG4gICAgdGhpcy5zYWxlUHJpY2UgPSBwYXJzZUZsb2F0KHNhbGVQcmljZS5yZXBsYWNlKC9bXjAtOVxcLi1dKy9nLCAnJykpO1xuICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTtcbiAgICB0aGlzLmJyYW5kID0gYnJhbmQ7XG5cbiAgfVxuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIG9yaWdpbmFsUHJpY2U6IG51bWJlcjtcbiAgc2FsZVByaWNlPzogbnVtYmVyO1xuICBpbWFnZTogc3RyaW5nO1xuICBicmFuZD86IHN0cmluZztcbn1cbiJdfQ==