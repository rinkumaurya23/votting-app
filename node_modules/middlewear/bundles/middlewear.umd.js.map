{"version":3,"file":"middlewear.umd.js.map","sources":["ng://middlewear/lib/middlewear.service.ts","ng://middlewear/lib/middlewear.module.ts"],"sourcesContent":["import { Injectable, EventEmitter } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n// import { environment } from 'environments/environment';\nlet environment;\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MiddlewareService {\n  items = new EventEmitter();\n  facets = new EventEmitter();\n  breadcrumbs = new EventEmitter();\n\n  constructor(private readonly http: HttpClient) { }\n\n  getCollectionByQuery(url?: string) {\n    url = url ? url : '';\n    return this.http.get(environment.apiUrl + 'category/' + url).subscribe(\n      (data: any) => {\n        console.log(data);\n        const result = data.universes.universe[0];\n        this.mapFredHopperProductsToProduct(result['items-section'].items.item);\n        this.mapFredHopperFacetMapToFacetMap(result.facetmap[0].filter);\n        this.mapFredHopperBreadcrumbsToBreadcrumbs(result.breadcrumbs);\n      });\n    }\n\n    mapFredHopperBreadcrumbsToBreadcrumbs(breadcrumbObject) {\n      const breadcrumbs = [];\n\n      this.breadcrumbs.emit(breadcrumbObject);\n    }\n\n    mapFredHopperFacetMapToFacetMap(listOfFredHopperFacetMaps: Array<any>) {\n      let facets = [];\n      facets = listOfFredHopperFacetMaps;\n      this.facets.emit(facets);\n\n    }\n\n    mapFredHopperProductsToProduct(listOfFredHopperProducts) {\n      const items = [];\n      listOfFredHopperProducts.forEach(element => {\n        const id = element.id;\n        const nameElement = element.attribute.find(x => x.name = 'name');\n        const name = nameElement.value[0].value;\n        const originalPriceElement = element.attribute.find(x => x.name === 'original_price');\n        const originalPrice = originalPriceElement.value[0].value;\n        const currentPriceElement = element.attribute.find(x => x.name === 'price');\n        const salePrice = currentPriceElement.value[0].value !== originalPrice ? currentPriceElement.value[0].value : '';\n        const imageElement = element.attribute.find(x => x.name === '_thumburl');\n        const image = imageElement.value[0].value;\n        const brandElement = element.attribute.find(x => x.name === 'brand');\n        const brand = brandElement.value[0].value ? brandElement.value[0].value : '';\n        items.push(new Product(id, name, image, originalPrice, salePrice,  brand));\n      });\n      this.items.emit(items);\n    }\n\n    navigateTo(url) {\n      this.getCollectionByQuery(url);\n    }\n}\n\nexport class Product {\n  constructor(id, name, image, originalPrice, salePrice?,  brand?) {\n    this.id = id;\n    this.name = name;\n    this.originalPrice = parseFloat(originalPrice.replace(/[^0-9\\.-]+/g, ''));\n    this.salePrice = parseFloat(salePrice.replace(/[^0-9\\.-]+/g, ''));\n    this.image = image;\n    this.brand = brand;\n\n  }\n  id: string;\n  name: string;\n  originalPrice: number;\n  salePrice?: number;\n  image: string;\n  brand?: string;\n}\n","import { NgModule, InjectionToken } from '@angular/core';\nimport { MiddlewareService } from './middlewear.service';\nimport { HttpClientModule } from '@angular/common/http';\nexport const API_HOST = new InjectionToken('API_HOST');\n\n@NgModule({\n  imports: [HttpClientModule],\n  providers: [MiddlewareService],\n})\nexport class MiddlewearModule {\n  static forRoot(host: string) {\n    return {\n      ngModule: MiddlewearModule,\n      providers: [{\n        provide: API_HOST,\n        useValue: host\n      }]\n    };\n  }\n}\n"],"names":["EventEmitter","Injectable","HttpClient","InjectionToken","NgModule","HttpClientModule"],"mappings":"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"}
